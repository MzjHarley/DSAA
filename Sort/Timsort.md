# Timsort 
Tim Peters在2002年为Python开发基础设施时结合使用归并和插入，并辅以另外一些技术手段，实现了后来被人称为Timsort的排序算法;  
**Timsort运用二分插入排序和归并排序，是归并排序的优化；减少了对升序部分的回溯和降序部分的性能倒退；**   
python内部的sorted和List.sort以及java中的Arrays.sort中同样用到Timsort;  

## Timsort的运用基于一个事实
现实生活中，大多数真实的数据集中，大部分元素是排好序的;即**不论一组数据多复杂，其局部是有序的；** 

## Timsort术语
**run:一组数据的集合，该组数据严格有序(单调递增或单调递减)，不能出现重复元素；**  
python内部元素个数>64时用Timsort;元素个数<64时用二分插入排序；  
java内部元素个数>32时用Timsort；元素个数<32时用二分插入排序；  

## Timsort步骤
+ 遍历全部元素，**查找严格单调递减或单调递增的区间**（区间长度:java为16到32;python为32到64；一般区间长度为2的n次方）并划分出区间放入栈中;（该栈为Run栈）  
+ 栈中满足规则： **Z>X+Y和Y>X**，这样可以提高归并的效率（X、Y、Z为run长度,Z、Y、X依次放入栈中）  
+ **栈中从上到下依次归并，得到有序数列**;  
## Timsort举例
对8，10，15，6，18，12，7，5，4，3，20，8，11，22，9，9，17排序  
这里元素较少，我们取区间最小长度为4；   
(1)8，15，16严格有序（严格单调递增），不过长度为3，不能划分为一个区间，故将后面的6运用二分插入排序放在前面的序列中，这样就划分一个区间run[0]={6,8,15,16}将其放入栈中;  
(2)18,12,7,5,4,3严格有序（严格单调递减），故将其逆序后划分为一个区间run[1]={3,4,5,7,12,18}将其放入栈中;  
(3)由于run[1]长度大于run[0],故让run[1]和run[0]出栈,并将其归并并记作run[0]={3,4,5,6,7,8,12,15,16,18},将run[0]放入栈中;  
(4)20,8严格有序，但长度为2，将11和22二分插入排序放在该序列中，将该序列逆序并划分成一个区间run[1]={8,11,20,22};将run[1]放入栈中;  
(5)最后三个元素只好划分为一个区间run[2],并将其放入栈中;  
(6)栈中从上到下依次归并，得到有序数列;  

## Timsort稳定，最好时间复杂度为o(n),最坏时间复杂度为o(nlogn);空间复杂度为o(nlogn);
